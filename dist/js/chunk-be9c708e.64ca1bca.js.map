{"version":3,"sources":["webpack:///./src/views/dataManage/hotBook/index.vue?5acb","webpack:///./src/utils/formRules.ts","webpack:///./src/views/dataManage/hotBook/index.vue?09f3","webpack:///./src/views/dataManage/hotBook/index.vue?51fd","webpack:///./src/views/dataManage/hotBook/index.vue","webpack:///./src/views/dataManage/hotBook/index.vue?2042"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","ref","rules","form","model","value","callback","$$v","$set","expression","headers","handleChange","handlePreview","handleRemove","handleSuccess","uploadFile","staticStyle","loading","on","onSubmit","staticRenderFns","label","required","message","trigger","max","min","pattern","name","FormRules","status","files","bookVO","token","window","sessionStorage","getItem","uploadForm","FormData","getNoEmpty","file","append","$refs","validate","valid","console","log","submit","getUploadBook","then","res","code","$message","type","catch","getSaveBook","tag","endsWith","showClose","response","fileList","clearValidate","component"],"mappings":"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","file":"js/chunk-be9c708e.64ca1bca.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"新增热门书籍\")])]),_c('el-form',{ref:\"form\",staticClass:\"ml-15\",attrs:{\"rules\":_vm.rules,\"model\":_vm.form,\"label-position\":'left',\"label-width\":\"150px\"}},[_c('el-form-item',{attrs:{\"label\":\"状态\",\"prop\":\"status\"}},[_c('el-radio-group',{model:{value:(_vm.form.status),callback:function ($$v) {_vm.$set(_vm.form, \"status\", $$v)},expression:\"form.status\"}},[_c('el-radio',{attrs:{\"label\":true}},[_vm._v(\"批量导入\")]),_c('el-radio',{attrs:{\"label\":false}},[_vm._v(\"手动录入\")])],1)],1),(_vm.form.status)?_c('el-form-item',{attrs:{\"label\":\"上传excel文件\",\"prop\":\"files\"}},[_c('el-upload',{ref:\"upload\",staticClass:\"upload-demo\",attrs:{\"name\":\"files\",\"accept\":\".xlsx,.xls,.XLSX,.XLS\",\"headers\":_vm.headers,\"action\":\"/upload/\",\"on-change\":_vm.handleChange,\"on-preview\":_vm.handlePreview,\"on-remove\":_vm.handleRemove,\"on-success\":_vm.handleSuccess,\"auto-upload\":false,\"http-request\":_vm.uploadFile,\"drag\":\"\"},model:{value:(_vm.form.files),callback:function ($$v) {_vm.$set(_vm.form, \"files\", $$v)},expression:\"form.files\"}},[_c('i',{staticClass:\"el-icon-upload\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\"将文件拖到此处，或\"),_c('em',[_vm._v(\"点击上传\")])]),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"只能上传excel文件\")])])],1):_c('el-form-item',{attrs:{\"label\":\"bookVO\",\"prop\":\"bookVO\"}},[_c('el-input',{staticStyle:{\"width\":\"3rem\"},attrs:{\"placeholder\":\"bookVO\"},model:{value:(_vm.form.bookVO),callback:function ($$v) {_vm.$set(_vm.form, \"bookVO\", $$v)},expression:\"form.bookVO\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(\"上传\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","class Rules {\n  public name(label: string) {\n    return [\n      { required: true, message: `请输入${label}`, trigger: 'blur' },\n      { max: 100, message: '不能超过 100 个字符', trigger: 'blur' },\n      { min: 2, message: '不能少于 2 个字符', trigger: 'blur' },\n      {\n        pattern: '^([a-z])([a-z0-9_-]){1,99}$',\n        message: `${label}需要以小写字母开头, 可包含小写字母, 数字, _和-, 并且长度在2-100之间.`,\n        trigger: 'blur',\n      },\n    ];\n  }\n\n  public getNoChinese() {\n    return { pattern: '^([^\\u4e00-\\u9fa5]){6,20}$', message: '不能输入中文,长度6-20' };\n  }\n\n  public getNoEmpty(name: string) {\n    return { required: true, message: `请输入${name}` };\n  }\n\n  public domainSelected(label: string) {\n    return [\n      { required: true, message: `请选择${label}`, trigger: 'blur' },\n    ];\n  }\n}\n\nexport const FormRules = new Rules();\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { HomeService } from '@/service';\nimport { ElForm } from '@/types/element-ui';\nimport { FormRules } from '@/utils/formRules';\nimport { Component, Vue } from 'vue-property-decorator';\n\nexport interface Form {\n  files: any;\n  status: boolean;\n  bookVO: string\n}\n\n@Component\nexport default class UploadBook extends Vue {\n  private form: Form = {\n    status: true,\n    files: '',\n    bookVO: '',\n  };\n  private loading: boolean = false;\n  public headers: object = {\n    token: window.sessionStorage.getItem('access_token'), // 请求头带token，获取token可以参考main.js中\n  };\n  public uploadForm = new FormData();\n  private rules = {\n    status: [FormRules.getNoEmpty('状态')],\n    files: [FormRules.getNoEmpty('文件')],\n    bookVO: [FormRules.getNoEmpty('bookVO')],\n  };\n\n  public uploadFile(file: { file: string | Blob; }) {\n    this.uploadForm.append('img', file.file);\n  }\n\n  private onSubmit() {\n    (this.$refs['form'] as ElForm).validate((valid, value) => {\n      console.log(this.form);\n      if (valid) {\n        this.loading = true;\n        if (this.form.status) {\n          (this.$refs['upload'] as ElForm).submit();\n          // this.uploadForm.append('img', this.form.files);\n          HomeService.getUploadBook(this.uploadForm).then((res: any) => {\n            if (res && res.code === 200) {\n              this.$message({\n                message: '上传成功',\n                type: 'success',\n              });\n              this.loading = false;\n            }\n          }).catch(() => {\n            this.loading = false;\n          });\n          console.log(this.uploadForm, 'this.uploadForm');\n        } else {\n          HomeService.getSaveBook(this.form).then((res: any) => {\n            if (res && res.code === 200) {\n              this.loading = false;\n            }\n          }).catch(() => {\n            this.loading = false;\n          });\n        }\n        console.log(this.form);\n      }\n    });\n  };\n\n  public beforeAvatarUpload(file: { name: any; size: number; }) {\n    let tag = file.name;\n    if (!tag.endsWith('.xlsx') && !tag.endsWith('.xls') && !tag.endsWith('.XLSX') && !tag.endsWith('.XLS')) {\n      this.$message({\n        showClose: true,\n        message: '只能上传Excel文件',\n        type: 'error',\n      });\n      return false;\n    }\n  }\n\n  handleSuccess(response: { code: string; message: any; }, file: { name: any; }, fileList: any) {\n    // 根据状态码判断上传是否成功\n    (this.$refs['form'] as ElForm).clearValidate('files');\n    console.log(response, 'res');\n  }\n\n  handleChange(file: any, fileList: any) {\n    this.form.files = file;\n  }\n\n  private handleRemove(file: any, fileList: any) {\n    // console.log(file, fileList);\n  }\n\n  private handlePreview(file: any) {\n    // console.log(file);\n  }\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=5632af37&\"\nimport script from \"./index.vue?vue&type=script&lang=ts&\"\nexport * from \"./index.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}